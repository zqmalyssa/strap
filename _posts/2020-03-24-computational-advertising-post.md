---
layout: post
title: 计算广告
tags: [code, algorithm, internet]
author-id: zqmalyssa
---

计算广告学

#### 综述

计算广告与网页搜索、推荐系统，都是互联网时代具有挑战性的大规模计算问题。由于数据规模的要求，这些系统都较广泛地采用检索(Retrieval)加排序(Ranking)这样类搜索的系统架构，因而有非常多的相似之处。

广告不同于搜索或推荐，它首先是一项商业活动，其次才是一项在互联网环境下需要技术优化的商业活动；其次，这一商业活动中广告主、媒体和用户的利益都需要被认真考虑和满足，才能达到整个市场的平衡和不断发展，在线广告市场所有产品和商业形式的演进，都是在这一主题下发生的


CPM：按千次展示付费（Cost Per Mile，CPM）的计费方式
CPC：按点击付费（Cost per Click，CPC）

市场上产生了大量聚合各媒体的剩余流量，采用实时竞价方式为他们变现的产品形态――广告交易平台(Ad Exchange)，通过实时竞价的方式，按照定制化的人群标签购买广告，这样与广告交易平台接口的产品，我们称为需求方平台(Demand Side Platform, DSP)

ATD：自动交易终端
SSP：供应方平台

ROI：投入产出比

max
a1,···,T T∑i=1 r(ai,ui, ci)/ T∑i=1 pi

表达式中的a,u, c三个变量，分别代表广告、用户与上下文，即广告活动的三个参与主体。i代表从第1次到第T次之间的某一次广告展示。我们优化的目标，就是在这T次展示上的总产出(r)与总投入(p)的比，即ROI


r(a,u, c) = µ(a,u, c)· ν(a,u)

用 µ 表示 点击率 (Click through Rate, CTR) ，用 ν 表示 点击价值 (Click Value) ，而这两部分的乘积，即定量地表示了某次或若干次展示的期望 CPM 值，我们称之为 expected CPM(eCPM) 2

#### 整体技术架构

Ad Server：广告投放机

接收广告前端Web Server发来的请求，完成广告投放并返回最后页面片段的主逻辑

先通过倒排索引从大量的广告候选中等到少量符合条件或相关的候选，再在这个小的候选集上应用复杂而精确的排序方法找到综合收益最高的若干个广告。对广告投放机来说，最重要的指标是能同时处理的并发数，以及广告决策的延
迟。

广告检索，包括图中的Ad index和Ad retrieval两部分

广告排序，包括图中的Ad ranking和Click modeling两部分。这部分可以类比于人体的大脑，因为它是广告效果优化的关键

数据高速公路，即图中的Data highway。这部分完成的功能，是将在线投放的数据准实时传输到离线分布式计算平台与流式计算平台上，供后续处理和建模使用

用户日志生成，即图中的Session log generation。从各个渠道收集来日志，需要先整理成以用户ID为key的统一存储格式，我们把这样的日志称为用户日志(Session log)。这样整理的目的。是为了让后续的受众定向过与程更加简单高效

商业智能(Business Intelligence，BI)系统，包括ETL(Extract-Transform-Load)过程, Dashboard和Cube

行为定向，包括结构化标签库(Structural label base), Audience targeting, 以及User attributes的cache

上下文定向，包括半在线页面抓取(Near-line page fetcher)和Page attributes的cache：这部分与行为定向互相配合，负责给上下文页面打上标签，用于在线的广告投放中

定制化用户划分，即图中的Customized audience segmentation：由于广告是媒体替广告主完成用户接触，那么有时需要根据广告主的逻辑来划分用户群，这部分也是具有鲜明广告特色的模块

在线行为反馈：这部分指的是一些需要准实时完成的一些任务，包括短时的用户行为标签和短时用户点击反馈等

广告管理系统：这部分是广告操作者，即客户执行(Account execute, AE)与广告系统的接口，AE通过广告管理系统定制和调整广告投放，并且与数据仓库交互，获得投放统计数据以支持决策

实时竞价接口：这是广告交易市场实时向DSP发起广告询价请求，并根据竞价结果胜出DSP的程序交易接口。


#### 比较核心的技术

1、倒排索引
